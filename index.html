<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Family Tree - FamilyTree.js</title>
  <script src="https://balkan.app/js/FamilyTree.js"></script>
  <style>
    #tree { width: 100%; height: 700px; }
  </style>
</head>
<body>
  <h1>Family Tree (FamilyTree.js)</h1>
  <div id="tree"></div>
  <script>
    // Fetch data from your Google Apps Script endpoint
    fetch('https://script.google.com/macros/s/AKfycbyZZl2h8OBb2buS5Qv-3oumCNtC4e9xGHGRa0A6jGJ3Dq6BU8U5QblYnK7nRBz-_WNhVQ/exec')
      .then(res => res.json())
      .then(data => {
        // Map your sheet data to FamilyTree.js format
        const nodes = data.map(d => ({
          id: d.id, // unique id
          name: d.panggilan || d.namalengkap || '-', // show "panggilan" as name
          gender: (d.kelamin && (d.kelamin.toUpperCase() === 'L' || d.kelamin.toLowerCase() === 'l')) ? 'laki-laki' : 'perempuan',
          pids: d.pid ? [d.pid] : [],
          fid: d.ida || undefined,
          mid: d.idi || undefined,
          domisili: d.domisili,
          tahunlahir: d.tahunlahir,
          tahunmeninggal: d.tahunmeninggal,
          namabapak: d.namabapak,
          namaibu: d.namaibu,
        }));

        // Show the family tree
        new FamilyTree(document.getElementById("tree"), {
          nodes,
          nodeBinding: {
            field_0: "name"
          },
          // Custom gender labels (optional for your use case)
          // If you want to show gender in the node, you can add more nodeBinding settings
        });
      });
  </script>
</body>
</html>
